!function(d,c,a){d.fn.extend({addTemporaryClass:function(f,h,e){var g=this;setTimeout(function(){g.removeClass(f);if(e){e()}},h);return this.each(function(){d(this).addClass(f)})},showDelayed:function(e,f){var g=this;if(!g.hasClass("is-active")){setTimeout(function(){g.addClass("is-active");if(f){f()}},e)}else{g.removeClass(".is-active");if(f){f()}}return this.each(function(){d(this).addTemporaryClass("is-transitioning",e)})},hideAnimated:function(i,h){var g=this;g.css("height","auto");g.css("display","block");var e=g.height();var f=g.hasClass("is-active");if(!f){g.css("height",0)}else{g.removeClass("is-active")}g.addTemporaryClass("is-transitioning",i);g.animate({opacity:!f,height:f?0:e},i,"linear",function(){g.toggleClass("is-active");g.attr("style",null);if(h){h()}})},isVisible:function(h,j){var f=d(this);var l=d(c);var k=l.scrollTop();var i=k+l.height();if(h){k+=h}if(j){i-=j}var e=f.offset().top;var g=e+f.height();return((g<=i)&&(e>=k))},safeText:function(){var e=d(this);var f=e.html();return f.trim().replace(/&nbsp;/g," ").replace(/^(<br\s?\/?>)+|(<br\s?\/?>)+$/,"").replace(/(<br\s?\/?>){3,}/,"<br><br>").replace(/<(div|p)[^>]*>/g,"<br>").replace(/((?!<br\s?\/?>)<[^>]*>?)/gm,"")}});d(a).ready(function(){b()});function b(){let vh=c.innerHeight*0.01;a.documentElement.style.setProperty("--vh",vh+"px")}c.onresize=function(){b()};core=d.extend({wsEvents:{open:[],message:[],close:[]},addWebSocketEventListener:function(f,e){core.wsEvents[f][core.wsEvents[f].length]=e}},core||{});if(core.visitor.user_id>0){core.addWebSocketEventListener("message",function(k){var j=JSON.parse(k.data);switch(j.type){case"new_message":var i=j.message;if(!location.href.endsWith("conv"+i.conversation_id)){var f=d(".alert-container");if(f.length===0){f=d("body").append('<div class="alert-container"></div>').find(".alert-container")}f.append('<div class="alert"><h4 class="alert-header">Новое сообщение!<span class="alert-close"></span></h4><a href="'+core.root+"/conv"+i.conversation_id+'" class="alert-content" data-conv="'+i.conversation_id+'"><span class="alert-username">'+i.sender_User["username"]+'</span><span class="alert-message">'+i.message+"</span></a></div>");var g=d(".badge.badge--conversation");g.attr("data-badge",parseInt(g.attr("data-badge"))+1);var h=f.find(".alert").last();h.hideAnimated(50);h.on("click",".alert-close, .alert-content",function(){h.hideAnimated(50,function(){h.remove()})});setTimeout(function(){h.hideAnimated(50,function(){h.remove()})},10000)}}})}d("body").on("click",".menu-trigger",function(g){var f=d(this);var h=f.next(".menu");if(h.length===0){return}h.toggleClass("is-open")})}(jQuery,window,document);